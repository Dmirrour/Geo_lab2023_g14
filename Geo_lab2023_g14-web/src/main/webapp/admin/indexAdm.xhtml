<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:p="http://primefaces.org/ui" xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:f="http://xmlns.jcp.org/jsf/core" lang="es" xml:lang="es">

<h:head>
   <meta http-equiv="X-UA-Compatible" content="IE=edge" />
   <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
   <meta name="viewport" content="width=device-width, initial-scale=1" />
   <title>Administrador</title>

   <link rel="stylesheet" href="lib/css/style.css" />
   <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous" />
   <script type="javascript" src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>

   <script src="lib/js/leaflet-src.js"></script>
   <script src="lib/js/leaflet.draw-src.js"></script>
   <script src="lib/js/leaflet.draw-shapefile.js"></script>

   <link rel="stylesheet" href="lib/css/leaflet.css" />
   <link rel="stylesheet" href="lib/css/leaflet.draw.css" />
   <link rel="stylesheet" href="lib/css/leaflet.draw-shapefile.css" />

   <style>
      html,
      body,
      #map {
         padding: 0;
         margin: 0;
         width: 100%;
         height: 550px;
      }
   </style>
   <h:outputStylesheet name="primeicons/primeicons.css" library="primefaces" />
   #{sesion.init()}
</h:head>

<body onload="init()">
   <div id="top">
      <div class="navbar navbar-expand-sm navbar-dark bg-dark">
         <div class="container-fluid">
            <a class="navbar-brand" href="javascript:void(0)">Administrador</a>
            <div class="d-flex" id="mynavbar">
               <ul class="navbar-nav me-auto">
                  <li class="nav-item">
                     <a class="nav-link" href="javascript:void(0)">Opciones</a>
                  </li>
                  <li class="nav-item">
                     <a class="nav-link" value="Cerrar sesión" href="/Geo_lab2023_g14-web/login.xhtml">Cerrar Sesión</a>
                  </li>
               </ul>
            </div>

         </div>
      </div>
   </div>
   <div id="map"></div>
</body>

<script>
   var map, drawControl, drawLayers, marcador, circulo;
   function init() {
      var topo = L.tileLayer('http://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png', {
         attribution: '© Grupo 14'
      });

      map = L.map('map', {
         center: [-34.8797018070320851, -56.262557241497211],
         zoom: 13,
         minZoom: 2,
         maxZoom: 18,
         layers: [topo],
         zoomControl: true
      });
      marcador = L.marker([-34.8797018070320851, -56.262557241497211]).addTo(map) // establece icono del marcado
      marcador.bindPopup("Casa Sebastián")

      circulo = L.circle([-34.8797018070320851, -56.262557241497211], {
         radius: 1500,
         color: "green"
      }).addTo(map)
      circulo.bindPopup("Villa del Cerro")

      drawLayers = new L.FeatureGroup();
      drawControl = new L.Control.DrawPlus({
         position: 'topright',
         draw: {
            circle: true,
            polyline: true,
         },
         edit: {
            featureGroup: drawLayers,
            edit: true
         }
      });
      map.addLayer(drawLayers);
      map.addControl(drawControl);

      map.on(L.Draw.Event.CREATED, function (e) {
         drawLayers.addLayer(e.layer);
      });

      drawLayers.on('click', function (e) {
         let latitud = e.latlng.lat;
         let longitud = e.latlng.lng;
         alert("Click en coordenadas: " + "\n" + "[" + latitud + "] [" + longitud + "]")
         console.log("Click en coordenadas: ")
         console.log("Latitud:", latitud.toFixed(2)) // .toFixed(2) muestra 2 decimales(no usar para guardar datos en bd)
         console.log("Longitud:", longitud.toFixed(2))
         console.log(e.layer);
      });
   }
</script>

</html>